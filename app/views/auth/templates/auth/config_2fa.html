{% extends "base.html" %}

{% block content %}
    
    {% include "navbar.html" %}

    <h1>{% block title %} Set up Two-Factor Authentication {% endblock %}</h1>

    <div class="card mt-3">
        <div class="row m-3">
            <div class="col-lg-6 col-md-12 col-sm-12">
                <img class="mx-auto d-block" src="data:image/png;base64,{{ img_data }}" alt="QR Code">
                <div class="text-center mt-3">Or enter this key manually</div>
                <div class="alert alert-danger text-center mt-3" role="alert">{{ secret }}</div>
            </div>
            <div class="col-lg-6 col-md-12 col-sm-12">
                <form method="POST">
                    {{ form.csrf_token }}
                    <h4>Enter the 6-digit code generated by the app</h4>
                    <div class="form-group">
                        <label for="token">{{ form.token.label }}</label>
                        {{ form.token(size=10, class="form-control") }}
                    </div>
                    <div class="text-end">
                        <div class="form-group mt-3">
                            <a href="{{ url_for('account.account') }}" class="btn btn-secondary" tabindex="-1" role="button" aria-disabled="true">
                                Cancel
                            </a>
                            {{ form.submit(class="btn btn-primary") }}
                        </div>
                    </div>
                </form>
                <hr>
                <p>Download an authenticator app like Google Authenticator</p>
                <p><a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2">Android</a></p>
                <p><a href="https://apps.apple.com/es/app/google-authenticator/id388497605">IOS</a></p>
            </div>
        </div>
    </div>
    
{% endblock %}